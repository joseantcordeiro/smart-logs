{
	"metadata": {
		"action": "fhir.patient.read",
		"spanId": "95ee094cefc272a4",
		"traceId": "64c618901f31b885a8d5d275378f8deb",
		"eventData": {
			"hash": "d3feecd33f70ea97c61792e4de1fef219fc7dc45ad714388a98a9c12e313a731",
			"action": "fhir.patient.read",
			"status": "failure",
			"signature": "0b50180156ce2850085d9abee32f1c7453c337dcfa8fa05be8d1c07c7ddb00d4",
			"timestamp": "2025-08-22T16:30:45.013Z",
			"principalId": "practitioner-11111",
			"eventVersion": "1.0",
			"hashAlgorithm": "SHA-256",
			"organizationId": "QEPNtdiiamOqeVdojZUyoPl9eM9srHQl",
			"sessionContext": {
				"ipAddress": "10.0.1.75",
				"sessionId": "sess-medical-456",
				"userAgent": "EMR-System/2.1.0"
			},
			"retentionPolicy": 2555,
			"targetResourceId": "patient-98765",
			"dataClassification": "PHI",
			"outcomeDescription": "Access denied - practitioner not authorized for this patient",
			"targetResourceType": "Patient"
		},
		"targetResourceId": "patient-98765",
		"targetResourceType": "Patient"
	},
	"stackTrace": "Error: Failed query: insert into \"audit_log\" (\"id\", \"timestamp\", \"ttl\", \"principal_id\", \"organization_id\", \"action\", \"target_resource_type\", \"target_resource_id\", \"status\", \"outcome_description\", \"hash\", \"hash_algorithm\", \"event_version\", \"correlation_id\", \"data_classification\", \"retention_policy\", \"processing_latency\", \"archived_at\", \"details\") values (default, $1, default, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, default, $12, $13, $14, default, $15)\nparams: 2025-08-22T16:30:45.013Z,practitioner-11111,QEPNtdiiamOqeVdojZUyoPl9eM9srHQl,fhir.patient.read,Patient,patient-98765,failure,Access denied - practitioner not authorized for this patient,d3feecd33f70ea97c61792e4de1fef219fc7dc45ad714388a98a9c12e313a731,SHA-256,1.0,PHI,2555,1.5645530000329018,{\"sessionContext\":{\"sessionId\":\"sess-medical-456\",\"ipAddress\":\"10.0.1.75\",\"userAgent\":\"EMR-System/2.1.0\"},\"signature\":\"0b50180156ce2850085d9abee32f1c7453c337dcfa8fa05be8d1c07c7ddb00d4\"}\n    at PostgresJsPreparedQuery.queryWithCache (/app/node_modules/src/pg-core/session.ts:74:11)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async ReliableEventProcessor.processAuditEvent (/app/apps/worker/src/index.ts:464:4)\n    at async executeWithRetry (file:///app/packages/audit/dist/retry.js:77:28)\n    at async file:///app/packages/audit/dist/queue/reliable-processor.js:143:37\n    at async CircuitBreaker.execute (file:///app/packages/audit/dist/queue/circuit-breaker.js:38:28)\n    at async ReliableEventProcessor.processJobWithReliability (file:///app/packages/audit/dist/queue/reliable-processor.js:142:13)\n    at async worker.Worker.connection [as processFn] (file:///app/packages/audit/dist/queue/reliable-processor.js:74:17)\n    at async <anonymous> (/app/node_modules/bullmq/src/classes/worker.ts:884:26)\n    at async Worker.retryIfFailed (/app/node_modules/bullmq/src/classes/worker.ts:1251:16)",
	"environment": {
		"hostname": "bd2b0155255f",
		"platform": "linux",
		"processId": 30,
		"nodeVersion": "v22.18.0"
	}
}
